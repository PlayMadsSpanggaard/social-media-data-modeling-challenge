version: 2

models:

  - name: int_yt_combined_data
    description: |
      This intermediate dataset consolidates all data by combining information from the joined staging tables.

    columns:
    - name: title
      description: |
        {{ doc("stg_trending_yt_videos__title") }}

    - name: trending_date
      description: |
        {{ doc("stg_trending_yt_videos__trending_date") }}        
      tests:
        - not_null

    - name: country_id
      description: |
        {{ doc("stg_trending_yt_videos__country_id") }}
      tests:
        - not_null        

    - name: view_count
      description: |
        {{ doc("stg_trending_yt_videos__view_count") }}

    - name: like_count
      description: |
        {{ doc("stg_trending_yt_videos__like_count") }}

    - name: comment_count
      description: |
        {{ doc("stg_trending_yt_videos__comment_count") }}

    - name: description
      description: |
        {{ doc("stg_trending_yt_videos__description") }}

    - name: thumbnail_url
      description: |
        {{ doc("stg_trending_yt_videos__thumbnail_url") }}

    - name: video_id
      description: |
        {{ doc("stg_trending_yt_videos__video_id") }}
      tests:
        - not_null        

    - name: video_tags
      description: |
        {{ doc("stg_trending_yt_videos__video_tags") }}                                                                

    - name: publish_date
      description: |
        {{ doc("stg_trending_yt_videos__publish_date") }}

    - name: total_minutes
      description: |
        {{ doc("stg_video_details__total_minutes") }}

    - name: caption
      description: |
        {{ doc("stg_video_details__caption") }}

    - name: category_name
      description: |
        Category names associated with the category IDs of YouTube videos.

    - name: title_emoji_flag
      description: |
        {{ doc("stg_title_description_emoji_presence__title_emoji_flag") }}

    - name: description_emoji_flag
      description: |
        {{ doc("stg_title_description_emoji_presence__description_emoji_flag") }}                                        

    - name: title_excluding_emoji
      description: |
        {{ doc("stg_title_description_emoji_presence__title_excluding_emoji") }}                                        

    - name: description_excluding_emoji
      description: |
        {{ doc("stg_title_description_emoji_presence__description_excluding_emoji") }}                                        

    - name: text_present_flag
      description: |
        {{ doc("stg_thumbnail_analysis__text_present_flag") }}                                        

    - name: face_present_flag
      description: |
        {{ doc("stg_thumbnail_analysis__face_present_flag") }}                                                                        

    - name: country_cpm_rate
      description: |
        {{ doc("stg_country_cpm_rates__country_cpm_rate") }}

    - name: category_cpm_rate
      description: |
        {{ doc("stg_category_cpm_rates__category_cpm_rate") }}

    - name: publish_day
      description: |
        {{ doc("int_yt_combined_data__publish_day") }}

    - name: trending_day
      description: |
        {{ doc("int_yt_combined_data__trending_day") }}                

    - name: days_to_trend
      description: |
        {{ doc("int_yt_combined_data__days_to_trend") }}

    - name: engagement_rate
      description: |
        {{ doc("int_yt_combined_data__engagement_rate") }}

    - name: title_word_count
      description: |
        {{ doc("int_yt_combined_data__title_word_count") }}

    - name: video_tags_word_count
      description: |
        {{ doc("int_yt_combined_data__video_tags_word_count") }}

    - name: description_length
      description: |
        {{ doc("int_yt_combined_data__description_length") }}

    - name: country_cpm_revenue
      description: |
        {{ doc("int_yt_combined_data__country_cpm_revenue") }}

    - name: category_cpm_revenue
      description: |
        {{ doc("int_yt_combined_data__category_cpm_revenue") }}                                                                

    - name: estimated_revenue
      description: |
        {{ doc("int_yt_combined_data__estimated_revenue") }}                                                                

    - name: estimated_rpm
      description: |
        {{ doc("int_yt_combined_data__estimated_rpm") }}

    - name: estimated_rpm_per_minute
      description: |
        {{ doc("int_yt_combined_data__estimated_rpm_per_minute") }}        
        
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - video_id
            - trending_date
            - country_id